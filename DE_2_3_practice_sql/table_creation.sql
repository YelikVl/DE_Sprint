CREATE TABLE IF NOT EXISTS public.employees
(
    emp_id INT NOT NULL,
    full_name VARCHAR(255) NOT NULL,
    birthday date,
    start_date date,
    job_title VARCHAR(255),
    grade_level VARCHAR(10) NOT NULL,
    salary INT,
    dep_id INT,
    driving_license BOOL DEFAULT false,
    PRIMARY KEY (emp_id)
);


CREATE TABLE IF NOT EXISTS public.departments
(
    dep_id INT NOT NULL,
    dep_name VARCHAR,
    manager_name VARCHAR(255),
    num_employees INT,
    CONSTRAINT dep_id PRIMARY KEY (dep_id)
);


CREATE TABLE IF NOT EXISTS public.bonus_grades
(
    grade_id serial,
    emp_id INT NOT NULL,
    year integer NOT NULL,
    qr integer NOT NULL,
    grade "char",
    PRIMARY KEY (grade_id)
);


ALTER TABLE IF EXISTS public.employee
    ADD FOREIGN KEY (dep_id)
    REFERENCES public.departments (dep_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.bonus_grades
    ADD FOREIGN KEY (emp_id)
    REFERENCES public.employees (emp_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;
    
INSERT INTO departments VALUES
 (1001, 'IT','VASILI VASILIEV',3),
 (2001, 'SALES', 'DMITRY VASILIEV', 2),
 (3001, 'LOGISTICS', 'PAVEL PAVLOV', 3),
 (4001, 'ACCOUNTING', 'SERGEY PAVLOV', 2);


INSERT INTO employees VALUES
('12681','VASILI VASILIEV','1980-12-01','2010-09-01','IT DEPARTMENT MANAGER','LEAD',300000,1001,False),
('12682','NIKOLAY PAVLOV','1981-12-01','2012-09-01','TECHNICAL SUPPORT','MIDDLE',150000,1001,False),
('12683','ANDREY PAVLOV','1982-12-01','2020-09-01','TECHNICAL SUPPORT','JUNIOR',100000,1001,False),
('12684','DMITRY VASILIEV','1988-04-22','2010-09-16','SALES LEAD','LEAD',300000,2001,False),
('12685','ALEKSANDR PAVLOV','1995-01-03','2015-10-04','SALES MANAGER','SENIOR',200000,2001,False),
('12686','PAVEL PAVLOV','1978-11-24','2020-10-04','LOGISTICS LEAD','LEAD',150000,3001,False),
('12687','ANDREY VASILIEV','1988-11-24','2019-08-03','DRIVER','JUNIOR',80000,3001,true),
('12688','VASILIY ANDREEV','1989-11-24','2018-08-03','DRIVER','JUNIOR',80000,3001,true),
('12689','SERGEY PAVLOV','1975-07-07','2000-12-03','CHIEF ACCOUNTANT','LEAD',300000,4001,False),
('12690','NIKOLAY ANDREEV','1976-08-08','2015-02-03','ACCOUNTANT','SENIOR',180000,4001,False);


INSERT INTO bonus_grades(emp_id, year, qr, grade) VALUES
('12681',2021,1,'C'),('12681',2021,2,'B'),('12681',2021,3,'B'),('12681',2021,4,'B'),
('12682',2021,1,'C'),('12682',2021,2,'C'),('12682',2021,3,'C'),('12682',2021,4,'B'),
('12683',2021,1,'C'),('12683',2021,2,'C'),('12683',2021,3,'C'),('12683',2021,4,'C'),
('12684',2021,1,'B'),('12684',2021,2,'A'),('12684',2021,3,'B'),('12684',2021,4,'B'),
('12684',2021,1,'C'),('12684',2021,2,'C'),('12684',2021,3,'B'),('12684',2021,4,'C'),
('12685',2021,1,'A'),('12685',2021,2,'C'),('12685',2021,3,'B'),('12685',2021,4,'B'),
('12686',2021,1,'E'),('12686',2021,2,'C'),('12686',2021,3,'B'),('12686',2021,4,'B'),
('12687',2021,1,'B'),('12687',2021,2,'B'),('12687',2021,3,'A'),('12687',2021,4,'B'),
('12688',2021,1,'C'),('12688',2021,2,'C'),('12688',2021,3,'C'),('12688',2021,4,'C'),
('12689',2021,1,'B'),('12689',2021,2,'B'),('12689',2021,3,'A'),('12689',2021,4,'B'),
('12688',2021,1,'C'),('12690',2021,2,'C'),('12690',2021,3,'C'),('12690',2021,4,'C');

INSERT INTO departments VALUES
 (5001, 'DATA ANALYSIS','LEV MAKSIMOV',3);
 
 INSERT INTO employees VALUES
('15000','LEV MAKSIMOV','1980-12-01','2022-01-10','ANALYTICS LEAD','LEAD',300000,5001,False),
('15001','NIKOLAY PAVLOV','1981-12-01','2022-01-10','DATA ANALYST','SENIOR',200000,5001,False),
('15002','ANDREY PAVLOV','1982-12-01','2022-01-10','DATA ANALYST','MIDDLE',150000,5001,False);
 


